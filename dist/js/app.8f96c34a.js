(function(t){function e(e){for(var n,r,a=e[0],c=e[1],u=e[2],d=0,h=[];d<a.length;d++)r=a[d],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&h.push(s[r][0]),s[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);l&&l(e);while(h.length)h.shift()();return i.push.apply(i,u||[]),o()}function o(){for(var t,e=0;e<i.length;e++){for(var o=i[e],n=!0,a=1;a<o.length;a++){var c=o[a];0!==s[c]&&(n=!1)}n&&(i.splice(e--,1),t=r(r.s=o[0]))}return t}var n={},s={app:0},i=[];function r(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=n,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(o,n,function(e){return t[e]}.bind(null,n));return o},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=e,a=a.slice();for(var u=0;u<a.length;u++)e(a[u]);var l=c;i.push([0,"chunk-vendors"]),o()})({0:function(t,e,o){t.exports=o("56d7")},"127e":function(t,e,o){},3229:function(t,e,o){"use strict";var n=o("9613"),s=o.n(n);s.a},"56d7":function(t,e,o){"use strict";o.r(e);o("e260"),o("e6cf"),o("cca6"),o("a79d");var n=o("2b0e"),s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"app"}},[o("router-view")],1)},i=[],r=o("5530"),a=o("2f62"),c={created:function(){this.getNotes()},methods:Object(r["a"])({},Object(a["b"])("notes",{getNotes:"getNotes"}))},u=c,l=(o("e6a3"),o("2877")),d=Object(l["a"])(u,s,i,!1,null,null,null),h=d.exports,f=(o("b0c0"),o("8c4f")),m=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"page-home"},[o("div",{staticClass:"container"},[o("div",{staticClass:"wrap"},[o("router-link",{staticClass:"btn btn-success",attrs:{to:"/create"}},[t._v("Создать заметку")])],1),t.notes.length?o("div",{staticClass:"wrap"},t._l(t.notes,(function(t){return o("card-note",{key:t.id,attrs:{note:t}})})),1):o("div",{staticClass:"wrap"},[t._m(0)])])])},p=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"card"},[o("div",{staticClass:"title"},[t._v("Заметок не найдено")])])}],v=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"card",on:{click:function(e){return e.target!==e.currentTarget?null:t.goToEdit(t.note)}}},[o("div",{staticClass:"wrap-title"},[o("div",{staticClass:"title"},[t._v(t._s(t.note.title))]),o("button",{staticClass:"btn btn-delete",attrs:{title:"Удалить"},on:{click:function(e){return e.stopPropagation(),t.deleteNote(t.note)}}},[o("i",{staticClass:"icon-delete-large"})]),o("confirm",{attrs:{show:t.confirm.delete.show,text:t.confirm.delete.text},on:{confirm:t.confirmDeleteNote}})],1),t._l(t.previewTodos,(function(e){return o("div",{staticClass:"todo",class:t.classTodoDone(e)},[o("i",{staticClass:"icon-checked"}),o("div",{staticClass:"todo-text"},[t._v(t._s(e.desc))])])})),o("div",{staticClass:"todo-count"},[t._v("Всего: "+t._s(t.note.todos.length))])],2)},b=[],g=(o("fb6a"),{props:{note:{type:Object,required:!0}},data:function(){return{confirm:{delete:{show:!1,text:"Вы действительно хотите удалить заметку?"}}}},computed:{previewTodos:function(){return this.note.todos.slice(0,3)}},methods:Object(r["a"])({},Object(a["b"])("notes",{removeNote:"removeNote"}),{goToEdit:function(t){var e="edit",o={id:t.id};this.$router.push({name:e,params:o})},classTodoDone:function(t){return{done:t.done}},deleteNote:function(){this.confirm.delete.show=!0},confirmDeleteNote:function(t){this.confirm.delete.show=!1,t&&this.removeNote(this.note)}})}),N=g,C=(o("9b0c"),Object(l["a"])(N,v,b,!1,null,"80698c30",null)),w=C.exports,y={components:{CardNote:w},computed:Object(r["a"])({},Object(a["c"])("notes",{notes:function(t){return t.notes}}))},x=y,_=(o("d6c6"),Object(l["a"])(x,m,p,!1,null,"6e862102",null)),O=_.exports,j=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"page-note"},[o("confirm",{attrs:{show:t.confirm.leave.show,text:t.confirm.leave.text},on:{confirm:t.confirmLeaveNote}}),o("div",{staticClass:"container"},[o("div",{staticClass:"wrap"},[o("router-link",{staticClass:"btn btn-back",attrs:{to:"/"}},[o("i",{staticClass:"icon-left"}),o("span",[t._v("Назад")])]),o("div",{staticClass:"btn-group-changes"},[o("div",{staticClass:"btn-group-text"},[t._v("Изменения:")]),o("button",{staticClass:"btn btn-prev",attrs:{title:"Предыдущее изменение",disabled:t.prevNoteDisabled},on:{click:t.prevNote}},[o("i",{staticClass:"icon-left"})]),o("button",{staticClass:"btn btn-next",attrs:{title:"Следующее изменение",disabled:t.nextNoteDisabled},on:{click:t.nextNote}},[o("i",{staticClass:"icon-right"})]),o("button",{staticClass:"btn btn-clear",attrs:{title:"Очистить изменения",disabled:t.clearNoteDisabled},on:{click:t.clearNote}},[o("i",{staticClass:"icon-clear"})]),o("confirm",{attrs:{show:t.confirm.clear.show,text:t.confirm.clear.text},on:{confirm:t.confirmClearNote}})],1)],1),o("div",{staticClass:"wrap"},[t.note.history.length?o("div",{staticClass:"card"},[o("div",{staticClass:"form-group-title"},[o("input",{staticClass:"input-control",attrs:{type:"text",name:"title",placeholder:"Название заметки",autocomplete:"off"},domProps:{value:t.note.history[t.note.curr].title},on:{input:function(e){return t.checkValid(e,"title")},change:function(e){return t.changeNote(e,"title")}}})]),t._l(t.note.history[t.note.curr].todos,(function(e,n){return o("div",{staticClass:"form-group-todo"},[o("div",{staticClass:"form-group-text"},[o("label",{staticClass:"custom-checkbox"},[o("input",{staticClass:"custom-input-control",attrs:{type:"checkbox",name:"done"},domProps:{value:e.done,checked:e.done},on:{change:function(e){return t.changeNote(e,"todos",n)}}}),t._m(0,!0)])]),o("input",{staticClass:"input-control",attrs:{type:"text",name:"desc",placeholder:"Описание действия",autocomplete:"off"},domProps:{value:e.desc},on:{input:function(e){return t.checkValid(e,"todos")},change:function(e){return t.changeNote(e,"todos",n)}}}),t.note.history[t.note.curr].todos.length>1?o("div",{staticClass:"form-group-text"},[o("button",{staticClass:"btn btn-delete",on:{click:function(e){return t.deleteNoteTodo(n)}}},[o("i",{staticClass:"icon-delete"})])]):t._e()])})),o("button",{staticClass:"btn btn-add",on:{click:t.addNoteTodo}},[o("i",{staticClass:"icon-add"}),o("span",[t._v("Добавить")])])],2):t._e()]),o("div",{staticClass:"wrap"},[o("button",{staticClass:"btn btn-primary",on:{click:t.saveNote}},[t._v("Сохранить")]),t.isCreatePage?t._e():o("button",{staticClass:"btn btn-danger ml-auto",on:{click:t.deleteNote}},[t._v("Удалить")]),o("confirm",{attrs:{show:t.confirm.delete.show,text:t.confirm.delete.text},on:{confirm:t.confirmDeleteNote}})],1)])],1)},k=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"custom-input-label"},[o("i",{staticClass:"icon-checked"})])}],S=(o("a623"),o("7db0"),o("d81d"),o("a434"),o("a9e3"),o("498a"),o("ade3")),I={props:{id:[String,Number]},data:function(){return{note:{curr:0,history:[]},confirm:{leave:{show:!1,text:"Вы действительно хотите покинуть страницу без сохранения?"},clear:{show:!1,text:"Вы действительно хотите очистить внесенные изменения?"},delete:{show:!1,text:"Вы действительно хотите удалить заметку?"}},routeLeave:{}}},computed:Object(r["a"])({},Object(a["c"])("notes",{notes:function(t){return t.notes}}),{isCreatePage:function(){return"create"==this.$route.name},prevNoteDisabled:function(){return this.note.curr<1},nextNoteDisabled:function(){return this.note.curr>=this.note.history.length-1},clearNoteDisabled:function(){return this.note.history.length<=1}}),mounted:function(){var t=this.getRefreshBrowser(),e=this.getNote(),o=this.initNote();t&&e?this.note=e:o?this.addNoteItem(o):this.$router.push("/")},beforeRouteLeave:function(t,e,o){var n=sessionStorage.getItem("note");this.routeLeave=t,n?(this.confirm.leave.show=!0,o(!1)):o()},methods:Object(r["a"])({},Object(a["b"])("notes",{createNote:"createNote",editNote:"editNote",removeNote:"removeNote"}),{getRefreshBrowser:function(){return"true"===sessionStorage.getItem("refreshBrowser")},confirmLeaveNote:function(t){this.confirm.leave.show=!1,t&&(this.setNote(),this.$router.push(this.routeLeave.path))},initNote:function(){var t=this,e={title:"",todos:[{done:!1,desc:""}]},o=this.notes.find((function(e){return e.id==t.id}));return this.isCreatePage?e:o},getNote:function(){var t=sessionStorage.getItem("note");return t?JSON.parse(t):t},setNote:function(t){t?sessionStorage.setItem("note",JSON.stringify(t)):sessionStorage.removeItem("note")},addNoteItem:function(t){this.note.history.push(t),this.note.curr=this.note.history.length-1},changeNote:function(t,e,o){var n=t.target,s="todos"==e,i=this.note.history[this.note.curr],r=s?this.changeNoteTodos(n,o):this.changeNoteTitle(n),a=Object.assign({},i,r);this.addNoteItem(a),this.setNote(this.note)},changeNoteTitle:function(t){var e=t.value;return{title:e}},changeNoteTodos:function(t,e){var o=t.name,n=t.value,s="desc"==o,i=this.note.history[this.note.curr].todos,r=i[e],a=Object(S["a"])({},o,s?n:"false"==n),c=Object.assign({},r,a),u=Object.assign([],i);return u.splice(e,1,c),{todos:u}},addNoteTodo:function(){var t=this.note.history[this.note.curr],e=Object.assign([],t.todos),o={done:!1,desc:""};e.push(o);var n={todos:e},s=Object.assign({},t,n);this.addNoteItem(s),this.setNote(this.note)},deleteNoteTodo:function(t){var e=this.note.history[this.note.curr],o=Object.assign([],e.todos);o.splice(t,1);var n={todos:o},s=Object.assign({},e,n);this.addNoteItem(s),this.setNote(this.note)},prevNote:function(){this.note.curr-=1,this.setNote(this.note)},nextNote:function(){this.note.curr+=1,this.setNote(this.note)},clearNote:function(){this.confirm.clear.show=!0},confirmClearNote:function(t){if(this.confirm.clear.show=!1,t){var e=this.initNote();this.note.history=[],this.setNote(),this.addNoteItem(e)}},checkValid:function(t,e){var o=t.target,n="todos"==e,s=""!=o.value.trim(),i=n?o.parentNode:o;s?i.classList.remove("error"):i.classList.add("error")},isValidForm:function(){var t=this.note.history[this.note.curr],e=""!=t.title.trim(),o=t.todos.map((function(t){return""!=t.desc.trim()})),n=o.every((function(t){return t}));return e&&n},saveNote:function(){var t=this.note.history[this.note.curr],e=this.isValidForm();if(e)this.isCreatePage?this.createNote(t):this.editNote(t),this.setNote(),this.$router.push("/");else{var o=document.querySelector("input[name=title]"),n=document.querySelectorAll("input[name=desc]");this.checkValid({target:o},"title");for(var s=0;s<n.length;s++)this.checkValid({target:n[s]},"todos")}},deleteNote:function(){this.confirm.delete.show=!0},confirmDeleteNote:function(t){if(this.confirm.delete.show=!1,t){var e=this.note.history[this.note.curr];this.removeNote(e),this.setNote(),this.$router.push("/")}}})},T=I,P=(o("5cb5"),Object(l["a"])(T,j,k,!1,null,null,null)),$=P.exports;n["a"].use(f["a"]);var D=[{path:"/",name:"home",component:O},{path:"/create",name:"create",component:$},{path:"/edit/:id",name:"edit",component:$,props:!0},{path:"*",redirect:"/"}],E=new f["a"]({mode:"history",base:"/",routes:D});E.beforeEach((function(t,e,o){var n=t.name,s=sessionStorage.getItem("page"),i=n==s;sessionStorage.setItem("page",n),sessionStorage.setItem("refreshBrowser",i),o()}));var L=E,V=(o("99af"),o("c740"),o("96cf"),o("1da1")),J=o("2909"),M=o("bc3a"),q=o.n(M),B={namespaced:!0,state:{notes:[]},mutations:{setNotes:function(t,e){var o;(o=t.notes).splice.apply(o,Object(J["a"])(e)),localStorage.setItem("notes",JSON.stringify(t.notes))}},actions:{getNotes:function(t){return Object(V["a"])(regeneratorRuntime.mark((function e(){var o,n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(o=t.commit,n=localStorage.getItem("notes"),n){e.next=9;break}return e.next=5,q.a.get("/api/notes.json");case 5:s=e.sent,n=s.data,e.next=10;break;case 9:n=JSON.parse(n);case 10:o("setNotes",[0,0].concat(Object(J["a"])(n)));case 11:case"end":return e.stop()}}),e)})))()},createNote:function(t,e){var o=t.state,n=t.commit,s=o.notes.map((function(t){return t.id})),i=s.length?Math.max.apply(Math,Object(J["a"])(s))+1:0;e=Object.assign({id:i},e);var r=o.notes.length;n("setNotes",[r,0,e])},editNote:function(t,e){var o=t.state,n=t.commit,s=o.notes.findIndex((function(t){return t.id===e.id}));n("setNotes",[s,1,e])},removeNote:function(t,e){var o=t.state,n=t.commit,s=o.notes.findIndex((function(t){return t.id===e.id}));console.log(s),n("setNotes",[s,1])}}};n["a"].use(a["a"]);var R=new a["a"].Store({modules:{notes:B}}),F=function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.show?o("div",{staticClass:"confirm-mask"},[o("div",{staticClass:"confirm-box"},[o("div",{staticClass:"confirm-text"},[t._v(t._s(t.text))]),o("button",{staticClass:"btn btn-danger",on:{click:function(e){return t.confirm(!0)}}},[t._v("Да")]),o("button",{staticClass:"btn btn-primary",on:{click:function(e){return t.confirm(!1)}}},[t._v("Нет")])])]):t._e()},A=[],z={props:{show:{type:Boolean,required:!0},text:{type:String,required:!0}},methods:{confirm:function(t){this.$emit("confirm",t)}}},G=z,H=(o("3229"),Object(l["a"])(G,F,A,!1,null,"6dddd674",null)),K=H.exports;n["a"].component("confirm",K),n["a"].config.productionTip=!1,new n["a"]({router:L,store:R,render:function(t){return t(h)}}).$mount("#app")},"5cb5":function(t,e,o){"use strict";var n=o("127e"),s=o.n(n);s.a},"867a":function(t,e,o){},9613:function(t,e,o){},"9b0c":function(t,e,o){"use strict";var n=o("de34"),s=o.n(n);s.a},a7b7:function(t,e,o){},d6c6:function(t,e,o){"use strict";var n=o("a7b7"),s=o.n(n);s.a},de34:function(t,e,o){},e6a3:function(t,e,o){"use strict";var n=o("867a"),s=o.n(n);s.a}});
//# sourceMappingURL=app.8f96c34a.js.map